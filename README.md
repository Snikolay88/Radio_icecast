# Cервера для радиовещания (Centos7 + Icecast)

____
## Оглавление

1. [Установка](#Установка)
2. [Настройка](#Настройка)
3. [Запуск](#Запуск)
____


## Установка

Устанавливаем расширенный репозиторий epel:
```bash
yum install epel-release
```
Устанавливаем icecast:
```bash
yum install icecast
```
____

## Настройка

Конфигурационный файл для Icecast находится в /etc
```bash
nano /etc/icecast.xml
```
<!-- ... --> является комментарием и не учитывается программой.

### Firewall
Добавить разрешение для 8000 порта в настройки iptables
```bash
iptables -I INPUT 1 -p tcp --dport 8000 -j ACCEPT
```
или настроить Firewalld 
```bash
firewall-cmd --permanent --add-port=8000/tcp
firewall-cmd --reload
```
### отключить SELinux
Посмотреть текущий статус системы безопасности можно командой:
```bash
getenforce
```
Варианты ответа: Enforcing / Permissive / Disabled — включен / только предупреждения / отключен.

#### Разово без перезагрузки
Введите команду:
```bash
setenforce 0
```
После перезагрузки системы все вернется как было. 
#### Отключить навсегда
Чтобы SELinux не запускался после перезагрузки, открываем на редактирование следующий файл:
```bash
nano /etc/selinux/config
```
И редактируем следующую строку:
```bash
...
SELINUX=disabled
...
```
_ * disabled отключает selinux, enforcing — включает. (italic)_

### Настройка icecast.xml
```
<clients>100</clients>
Количество одновременно подключенных пользователей. Выставляем желаемое.
<sources>3</sources>
Количество обрабатываемых сервером аудиопотоков. Если надо организовать несколько разных потоков аудио.

<source-password>mypass</source-password>
Пароль для присоединения потока к аудиосерверу IceCast.
< relay-password >mypass< /relay-password >
Пароль, используемый для пересылки аудиопотоков между локальным IceCast-сервером и другим IceCast-сервером. Эти пароли на обоих серверах должны совпадать.

<admin-user>admin</admin-user>
Логин администратора, обслуживающего сервер. По умолчанию admin.
<admin-password >pass</admin-password >
Пароль администратора. Используется для всех административных функций.

<port>8000</port>
Настройка номера TCP-порта. Значение по умолчанию 8000.

<bind-address>192.168.1.11</bind-address>
Привязка к сетевому адресу. Если параметр не указан, используется значение hostname.

```

## Запуск
Разрешаем сервис и запускаем его следующими командами
```bash
systemctl enable icecast

systemctl start icecast
```
Открываем браузер и переходим по пути http://192.168.0.15:8000/
_  * где 192.168.0.15 — IP-адрес нашего сервера, который мы прописали в bind-address конфига.(italic)_